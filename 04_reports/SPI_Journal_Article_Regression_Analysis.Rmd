---
title: "SPI Journal Article - Supplmental Tables & Figures"
author: "SPI Team"
date: "`r Sys.Date()`"
output:
  bookdown::word_document2: 
    toc: yes
    fig_width: 9
    fig_height: 6
    number_sections: true

---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 6, fig.cap = "")
library(plm)
library(tidyverse)
library(flextable)
library(here)
# devtools::install_github("worldbank/wbgviz", subdir = "wbgdata")
# devtools::install_github("worldbank/wbgviz", subdir = "wbgcharts")
# devtools::install_github("worldbank/wbgviz", subdir = "wbggeo")
# devtools::install_github("worldbank/wbgviz", subdir = "wbgmaps")
# library(wbggeo)
# library(wbgmaps)
library(ggthemes)
library(Hmisc)
library(httr)
library(patchwork)
library(ggrepel)
library(haven)
library(zoo)
library(estimatr)
library(ggpmisc)
library(ggthemes)
library(ggtext)
library(fixest)
library(modelsummary)
library(WDI)

#set directories
dir <- here()
raw_dir <- paste(dir, '01_raw_data', sep="/")
output_dir <- paste(dir, '03_output_data', sep="/")
dashboard_dir <- 'C:/Users/wb469649/OneDrive - WBG/DECIS/SPI/Data/regression_dashboard'
#weights (either unity (1) or population)
wgt <- 1
```


```{r load, include=FALSE}
#add in population
pop_df <- wbstats::wb_data(country="all",
             indicator='SP.POP.TOTL',
             start_date=2004,
             end_date=2020) %>%
  mutate(date=as.numeric(date)) %>%
  mutate(population=SP.POP.TOTL) %>%
  select(country, date, population) 
#import data
spi_index_df <- read_csv(paste(output_dir, 'SPI_index.csv', sep="/")) %>%
    left_join(pop_df) %>%
  mutate(weights=wgt)  #create a variable for weights for estimates.  This just makes is easier to switch between weights and unweighted estimates.
#read in the SPI dataset
spi_df_final <- read_csv( file = paste(output_dir, 'SPI_data.csv', sep="/")) %>%
  left_join(pop_df) %>%
  mutate(weights=wgt)  #create a variable for weights for estimates.  This just makes is easier to switch between weights and unweighted estimates.
#metadata 

metadata <- read_csv(paste(raw_dir, '/metadata/SPI_dimensions_sources.csv', sep=""))

metadata_full <- read_csv(paste(raw_dir, '/metadata/SPI_index_sources.csv', sep="")) %>%
  rename(source_name=descript) %>%
  bind_rows(metadata)

metadata <- data.frame(
  series = c('SPI.INDEX', 'SPI.INDEX.PIL1', 'SPI.INDEX.PIL2', 'SPI.INDEX.PIL3', 'SPI.INDEX.PIL4', 'SPI.INDEX.PIL5'),
  indicator_name = c('SPI Overall Score', 'Pillar 1: Data Use', 'Pillar 2: Data Services', 'Pillar 3: Data Products', 'Pillar 4: Data Sources', 'Pillar 5: Data Infrastructure')
)
#get list of country info
country_list <- wbstats::wb_countries()

SPI_WDI <- read_csv('https://raw.githubusercontent.com/worldbank/SPI/master/03_output_data/SPI_index.csv') %>%
    left_join(pop_df) %>%
  mutate(weights=wgt)  #create a variable for weights for estimates.  This just makes is easier to switch between weights and unweighted estimates.


SPI_2020 <- spi_index_df %>%
  filter(date==2020) %>%
  filter(!is.na(SPI.INDEX) & !is.na(weights)) %>%
  mutate(ISO_A3_EH=iso3c) 


SPI <- SPI_2020 %>%
  bind_rows(SPI_WDI)
#read in TopoJSON from World Bank
#countries <- geojsonio::geojson_read("WB_countries_Admin0_lowres.geojson",
#                                     what = "sp")
```



# Estimating Relationship between Statistical Performance and Economic Growth

```{r regdf, echo=FALSE}
options(modelsummary_factory_word = 'flextable')
custom_theme <- function(x, ...) {
    x %>% set_table_properties(layout = "autofit")
}
options("modelsummary_theme_flextable" = custom_theme)


#get some potential predictors
# predictors_df <- WDI(
#   indicator = c('NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','SE.SEC.CMPT.LO.ZS','NE.TRD.GNFS.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST"),
#   start=2015,
#   end=2020,
#   extra=TRUE
#   ) %>% 
#   dplyr::arrange(iso3c,-year) %>%
#   filter(region!="Aggregates") %>%
#   rename(date=year)

predictors_df <- wbstats::wb_data(country="countries_only",
             indicator=c('NY.GDP.PCAP.KD', 'NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','NE.TRD.GNFS.ZS', 'HD.HCI.OVRL','SE.PRM.ENRR','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "BX.KLT.DINV.WD.GD.ZS", "SI.POV.DDAY", "SI.POV.GINI"),
             start_date=2010,
             end_date=2020) %>%
  mutate(date=as.numeric(date)) %>%
  arrange(iso3c, date) %>%
  group_by(iso3c) %>%
  mutate(across(c( 'NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS', 'SE.PRM.ENRR', 'HD.HCI.OVRL','NE.TRD.GNFS.ZS','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "BX.KLT.DINV.WD.GD.ZS","SI.POV.DDAY", "SI.POV.GINI"),
                ~if_else(is.na(.),1,0),
                .names="{.col}_imp_tag")) %>% #add tag for data that is imputed
  fill(c( 'NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS', 'SE.PRM.ENRR', 'HD.HCI.OVRL','NE.TRD.GNFS.ZS','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "BX.KLT.DINV.WD.GD.ZS","SI.POV.DDAY", "SI.POV.GINI"), .direction="downup") %>%
  mutate(WGI.OVL=(CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST)/6,
         lag_outcome=lag(NY.GDP.PCAP.KD),
         lag_fdi=lag(BX.KLT.DINV.WD.GD.ZS),
         lag_ge=lag(GE.EST),
         lag_poverty=lag(SI.POV.DDAY),
         lag_gini=lag(SI.POV.GINI)
         )  %>%
  ungroup()

#non imputed

non_imp_predictors_df <- wbstats::wb_data(country="countries_only",
             indicator=c('NY.GDP.PCAP.KD', 'NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','NE.TRD.GNFS.ZS', 'HD.HCI.OVRL','SE.PRM.ENRR','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "BX.KLT.DINV.WD.GD.ZS", "SI.POV.DDAY", "SI.POV.GINI"),
             start_date=2010,
             end_date=2020) %>%
  mutate(date=as.numeric(date)) %>%
  arrange(iso3c, date) %>%
  group_by(iso3c) %>%
  #fill(c( 'NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS', 'SE.PRM.ENRR', 'HD.HCI.OVRL','NE.TRD.GNFS.ZS','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "BX.KLT.DINV.WD.GD.ZS","SI.POV.DDAY", "SI.POV.GINI"), .direction="downup") %>%
  mutate(WGI.OVL=(CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST)/6,
         lag_outcome=lag(NY.GDP.PCAP.KD),
         lag_fdi=lag(BX.KLT.DINV.WD.GD.ZS),
         lag_ge=lag(GE.EST),
         lag_poverty=lag(SI.POV.DDAY),
         lag_gini=lag(SI.POV.GINI)
         )  %>%
  ungroup()

#get central government debt data from IMF which is more complete source
imf_dta <- haven::read_dta("C:/Users/wb469649/OneDrive - WBG/DECIS/SPI/Blog - SPI and Bond Spreads/01_Data/Global Debt Database_121521_to_DATAMAPPER.dta" ) %>% 
  rename(imf_code=ifscode,
         date=year) %>%
  left_join(read_csv(file="C:/Users/wb469649/Documents/Github/Gender-SPI/01_raw_data/metadata/IMF_country_codes.csv")) %>%
  select(iso3c, date, cg)

# predictors_df <- predictors_df %>%
#   left_join(imf_dta)

SPI_2016 <- SPI %>%
  filter(date>=2016) %>%
  group_by(iso3c) %>%
  #fill(starts_with( 'SPI.INDEX'), .direction="downup") %>%
  ungroup() %>%
  filter(!is.na(SPI.INDEX))

countries_2016 <- unique(SPI_2016$country)

#add in some metadata about the country
reg_df <- SPI_2016 %>%
  select(country, iso3c, date, region, SPI.INDEX, SPI.INDEX.PIL1, SPI.INDEX.PIL2, SPI.INDEX.PIL3, SPI.INDEX.PIL4, SPI.INDEX.PIL5) %>%
  left_join(predictors_df) %>%
  filter(between(date,2016,2020)) %>%
  write_excel_csv(paste0(dashboard_dir, "/SPI_full_regression_data.csv")) %>%
  filter(!(is.na(SPI.INDEX) | 
             is.na(NY.GDP.PCAP.KD) |
             is.na(NV.IND.MANF.ZS) |
             is.na(NV.AGR.TOTL.ZS) |
             is.na(SE.PRM.ENRR) |
             is.na(NE.TRD.GNFS.ZS) |
             #is.na(cg) | 
             #is.na(BN.CAB.XOKA.GD.ZS) |
             is.na(CC.EST) |
             is.na(GE.EST) |
             is.na(PV.EST) |
             is.na(RQ.EST) |
             is.na(RL.EST) |
             is.na(VA.EST) )) %>%
  mutate(region_year_fe=paste(region,date,sep=" - "))

write_excel_csv(reg_df, paste0(dashboard_dir, "/reg_dashboard_data.csv"))

#nonimputed
#add in some metadata about the country
non_imp_reg_df <- SPI_2016 %>%
  select(country, iso3c, date, region, SPI.INDEX, SPI.INDEX.PIL1, SPI.INDEX.PIL2, SPI.INDEX.PIL3, SPI.INDEX.PIL4, SPI.INDEX.PIL5) %>%
  left_join(non_imp_predictors_df) %>%
  filter(between(date,2016,2020)) %>%
  filter(!(is.na(SPI.INDEX) | 
             is.na(NY.GDP.PCAP.KD) |
             is.na(NV.IND.MANF.ZS) |
             is.na(NV.AGR.TOTL.ZS) |
             is.na(SE.PRM.ENRR) |
             is.na(NE.TRD.GNFS.ZS) |
             #is.na(cg) | 
             #is.na(BN.CAB.XOKA.GD.ZS) |
             is.na(CC.EST) |
             is.na(GE.EST) |
             is.na(PV.EST) |
             is.na(RQ.EST) |
             is.na(RL.EST) |
             is.na(VA.EST) )) %>%
  mutate(region_year_fe=paste(region,date,sep=" - "))

write_excel_csv(non_imp_reg_df, paste0(dashboard_dir, "/non_imputed_reg_dashboard_data.csv"))


ncountry <- length(unique(reg_df$country))

#use modelsumary to predict
#modelsummary output
gm <- tibble::tribble(
  ~raw,        ~clean,          ~fmt,
  "nobs",      "N",             0)


cross_reg_df <- reg_df %>%
  arrange(country) %>%
  group_by(country, iso3c) %>%
  summarise(growth=log(first(NY.GDP.PCAP.KD))-log(last(NY.GDP.PCAP.KD)),
            across(c('SPI.INDEX','NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','NE.TRD.GNFS.ZS','SE.PRM.ENRR', 'HD.HCI.OVRL','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST",  "WGI.OVL",'region'),~last(.))
            
            )



#create regression models
 models <- list(


 'Dynamic Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  log(lag_outcome) + SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date   , data=reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  log(lag_outcome) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  | date  , data=reg_df, se='cluster', cluster='country') ,
   
   
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date, data=reg_df, se='cluster', cluster='country') ,
 # 
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date , data=reg_df, se='cluster', cluster='country') ,

 # 'Longitudinal Model (Country RE/Year FE)' = plm::plm(log(NY.GDP.PCAP.KD) ~  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  + factor(date), data=reg_df, model='random', index=c('iso3c')) ,
 # 

 'Longitudinal Model (Country FE/Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Longitudinal Model (Country FE/Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=log(NY.GDP.PCAP.KD) ~ lag(log(NY.GDP.PCAP.KD), 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(log(NY.GDP.PCAP.KD), 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date')),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=log(NY.GDP.PCAP.KD) ~ lag(log(NY.GDP.PCAP.KD), 1) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(log(NY.GDP.PCAP.KD), 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date'))
 

 )



```

```{r include=FALSE}
# test between fixed and random effects estiamtes

fixed <- plm::plm(log(NY.GDP.PCAP.KD) ~   SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + BN.CAB.XOKA.GD.ZS + WGI.OVL  , data=reg_df, model='within', index=c('iso3c'), effect='twoways')

summary(fixed)

random <- plm::plm(log(NY.GDP.PCAP.KD) ~   SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + BN.CAB.XOKA.GD.ZS + WGI.OVL  , data=reg_df, model='random', index=c('iso3c'))

summary(random)



plm::phtest(fixed, random, method="aux", vcov=function(x) vcovHC(x, method="white2", type="HC3"))

```

In this analysis, the relationship between statistical performance and economic growth and other intermediate indicators of economic growth will be examined using a two alternative econometric model. The sample consists of `r ncountry` countries, which have a non-missing data with a time span between 2016 and 2020.^[`r length(countries_2016)` countries have a non-missing SPI score in 2016.  The binding constraint keeping most countries from having an SPI score in 2016 is the availability of data from the Open Data Inventory (ODIN), produced by Open Data Watch, which was used for the SPI measures of data openness and geospatial information. The remainder of countries omitted lack either a human capital index score or some cases trade data.]  

The first econometric model is a dynamic linear model where GDP per capita follows a random walk and a structural component made up of the SPI score and other covariates. The linear model includes the lag of log GDP per capita as a control as well as the SPI and other control variables.  To account for global macroeocnomic fluctuations, the model also includes a dummy variable for the year. In the tables, this model is referred to as the "Dynamic Model".  The specification is:

$$ GDPpc_{i,t} = \alpha + \gamma GDPpc_{i,(t-1)}+ \beta_1 SPI_{i,t}  + \beta2 MFG_{i,t} + \beta_3 AG_{i,t} + \beta_4 Sch_{i,t} + \beta_5 Trade_{i,t} + \beta_6 PolInst_{i,t} + \tau_t+ \epsilon_{i,t} $$

where $GDPpc_{i,t}$ is the log of GDP per capita based on 2015 constant US dollars for country $c$ in year $t$.  $SPI_{i,t}$ is the value of the SPI overall score in year $t$.  $GDPpc_{i,(t-1)}$ is the level of GDP per capita in the previous year.  $MFG_{i,16}$ and $AG_{i,16}$ are manufacturing value added and agricultural, forestry, and fishing value added as a percentage of GDP, which are measures of the sectoral composition of the economy.  $Sch_{i,t}$ is the school enrollment, primary (% gross) for the country in year t.  $Trade_{i,16}$ is the level of trade (exports + imports) as a percentage of GDP in year $t$.  Finally, $PolInst_{i,t}$ is an index of political institutions as measured by the [World Governance Indicators (WGI)](http://info.worldbank.org/governance/wgi/).  This is specified as the average of the WGI scores related to control of corruption, governance effectiveness, political stability and absence of violence/terrorism, regulatory quality, rule of law, and voice and accountability. $\tau_t$ is a year dummy variable.  $\epsilon_{i,t}$ is an idiosyncratic error term.

The second model is a longitudinal model that will be estimated using a panel fixed effect estimator with country fixed effects and year fixed effects.  This model is named the "Longitudinal Model" in the tables below.

$$ GDPpc_{i,t} = \alpha + \beta_1 SPI_{i,t}  + \beta2 MFG_{i,t} + \beta_3 AG_{i,t} + \beta_4 HCI_{i,t} + \beta_5 Trade_{i,t} + \beta_6 PolInst_{i,t} + c_{i} + \tau_{t} + \epsilon_{i,t} $$

In this case,  the log lagged GDP per capita for country i in year t is dropped from the model.  $c_{i}$ representing the unobserved effect for country $i$ is included in the model, which accounts for time constant factors affecting GDP per capita in a specific country.

Finally, an Arellano and Bond (1991) estimator is considered, which estimates the Dynamic model above, but additionally controls for country fixed effects.  The dynamic model is estimated using Panel GMM by taking the first difference of the outcome and regressors, which includes the lagged dependent variable, and instruments for the lagged dependent variable using further lags of the dependent variable.  This is required, because the first difference of the lagged dependent variable will mechanically be correlated with the error term, and so the instrumental variables are required.  

An additional variant within each model is included as well, where the $SPI_{i,t}$ variable is split into the scores for each of the five SPI pillars (data use, data services, data products, data sources, and data infrastructure).  This specification allows the examination of which specific pillar may be driving changes in GDP per capita.

Results from estimating the models is below.  The "Dynamic Model" is estimated via OLS.  The "Longitudinal Model" is estimated using the panel fixed effects estimator (also known as the "within estimator") as discussed in Wooldridge (2010).  

In column (1) of the table which show estimates from the "Dynamic model", the results indicate that a one unit (scale 0-100) on the SPI overall score is associated with a increase of GDP per capita of 0.1%.  This is statistically significant at  the 1% level.  To give some perspective, the median country grew 5.5 points on the SPI overall score between 2016 and 2020.  The 75th percentile country grew 9.7 points and the 90th percentile country grew 13.3 points on the SPI scale.  A country that grew at the 75th percentile then would tend to have seen GDP per capita grow by nearly 1% according to these estimates.  In column (2) which breaks down the impacts into the underlying SPI pillar effects, shows a statistically significant (1% level), but small correlation of Pillar 5 on data infrastructure of 0.03%.  None of the other SPI pillars have detectable associations with GDP per capita.

In column (3), the "Longitudinal Model" estimates indicate no statistically significant association of the SPI overall score on GDP per capita, although the sign and magnitude is similar as in the dynamic model.  Column (4) indicates that the SPI Pillar 5 score on data infrastructure has a statistically significant effect (at 10% level) on GDP per capita.  The Arellano and Bond estimator in columns (5) and (6) show now statistically significant associations.

One potential explanation of the statistically significant association of the SPI Pillar 5 score on data infrastructure is that the data infrastructure indicators measure the recency of the national accounts base year and the system of national accounts (for instance SNA 2008 or older).  Improvements in the accounting of national accounts could lead to upward revisions in GDP for a country and a positive effect of these improvements on log GDP per capita.

Table. Relationship between Log GDP per capita and SPI scores using data from 2016-2020.

```{r}
 modelsummary(models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"HC1",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "log(lag_outcome)" = "Log lagged GDP per capita" ,
                              "lag(log(NY.GDP.PCAP.KD), 1)" = "Log lagged GDP per capita" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "HD.HCI.OVRL" = "Human Capital Index (0-1 scale)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "WGI.OVL" = "WGI Index",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include NY.GDP.MKTP.KD.ZG, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level",
              escape = FALSE
              )
```

As a specification check, an additional estimator is considered.  Rather than estimating the longitudinal model using country fixed effects using the within estimator, a country random effects estimator is considered.  The country random effects estimator imposes a stronger assumption that the country heterogeneity term, $c_i$, is uncorrleated with the other regressors.  This assumption, if valid, justifies the use of the more efficient random effects estimator.  However, a Hausman test of the assumption, which compares estimates from the fixed effects and random effects estimator (Wooldridge (2010), pg 328), is performed, and the test results in a rejection of the uncorrelatedness assumption.  Thus the random effects estimator may be biased. 


Table. Alternative Specification with Country Random Effects Estimator
```{r}


#create regression models
 models <- list(


 'Dynamic Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  log(lag_outcome) + SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date   , data=reg_df, se='cluster', cluster='country') ,

 # 'Dynamic Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  log(lag_outcome) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  | date  , data=reg_df, se='cluster', cluster='country') ,
   
   
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date, data=reg_df, se='cluster', cluster='country') ,
 # 
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date , data=reg_df, se='cluster', cluster='country') ,

 'Longitudinal Model (Country RE/Year FE)' = plm::plm(log(NY.GDP.PCAP.KD) ~  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  + factor(date), data=reg_df, model='random', index=c('iso3c')) ,
 # 

 'Longitudinal Model (Country FE/Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
'Arellano & Bond Dynamic Model (Country FE/Year FE)' = pgmm(formula=log(NY.GDP.PCAP.KD) ~ lag(log(NY.GDP.PCAP.KD), 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(log(NY.GDP.PCAP.KD), 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date'))
 
 # 'Longitudinal Model (Country FE/Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country')
 

 )

gm2 <- tibble::tribble(
  ~raw,        ~clean,          ~fmt,
  "nobs",      "N",             0,
  "r.squared", "R Sq.", 2)

 modelsummary(models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"HC1",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "log(lag_outcome)" = "Log lagged GDP per capita" ,
                              "lag(log(NY.GDP.PCAP.KD), 1)" = "Log lagged GDP per capita" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "HD.HCI.OVRL" = "Human Capital Index (0-1 scale)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "WGI.OVL" = "WGI Index",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include NY.GDP.MKTP.KD.ZG, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level"
              #escape = FALSE
              )
# m <- plm::pgmm(log(NY.GDP.PCAP.KD) ~ lag(log(NY.GDP.PCAP.KD), 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(log(NY.GDP.PCAP.KD), 2:3), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date')) 
# summary(m)
 
```



```{r include=FALSE}
# test between fixed and random effects estiamtes

fixed <- plm::plm(log(NY.GDP.PCAP.KD) ~   SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + BN.CAB.XOKA.GD.ZS + WGI.OVL  , data=reg_df, model='within', index=c('iso3c'), effect='twoways')

#summary(fixed)

random <- plm::plm(log(NY.GDP.PCAP.KD) ~   SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + BN.CAB.XOKA.GD.ZS + WGI.OVL  , data=reg_df, model='random', index=c('iso3c'))

#summary(random)



htest <- plm::phtest(fixed, random, method="aux", vcov=function(x) vcovHC(x, method="white2", type="HC3"))

```

## Poverty & Gini Impacts


Another two associations are considered: the association of the SPI on the $1.90 headcount ratio and the association on the Gini coefficent.  Data for both are sourced from the World Bank's Povcalnet. The same specifications are estimated as previously, except in the case of a dynamic model, the lagged dependent variables are replaced with either lagged poverty or the lagged Gini coefficient as the case may be.

Estimates are reported in the tables below.  Overall, there is little detectable association of the SPI with these outcomes.

Table. Relationship between $1.90 Poverty Headcount Ratio and SPI scores using data from 2016-2020.

```{r echo=FALSE}

#create regression models
 models <- list(


 'Dynamic Model (Year FE)' = feols(SI.POV.DDAY ~  lag_poverty + SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date   , data=reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(SI.POV.DDAY ~  lag_poverty +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  | date  , data=reg_df, se='cluster', cluster='country') ,
   
   
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date, data=reg_df, se='cluster', cluster='country') ,
 # 
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date , data=reg_df, se='cluster', cluster='country') ,

 # 'Longitudinal Model (Country RE/Year FE)' = plm::plm(log(NY.GDP.PCAP.KD) ~  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  + factor(date), data=reg_df, model='random', index=c('iso3c')) ,
 # 

 'Longitudinal Model (Country FE/Year FE)' = feols(SI.POV.DDAY ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Longitudinal Model (Country FE/Year FE)' = feols(SI.POV.DDAY ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=SI.POV.DDAY ~ lag(SI.POV.DDAY, 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(SI.POV.DDAY, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date')),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=SI.POV.DDAY ~ lag(SI.POV.DDAY, 1) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(SI.POV.DDAY, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date'))
 

 )



 modelsummary(models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"HC1",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "log(lag_poverty)" = "lagged Poverty" ,
                              "lag(SI.POV.DDAY, 1)" = "lagged Poverty" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "HD.HCI.OVRL" = "Human Capital Index (0-1 scale)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "WGI.OVL" = "WGI Index",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include NY.GDP.MKTP.KD.ZG, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level"
              #escape = FALSE
              )

```



Table. Relationship between Gini Coefficient and SPI scores using data from 2016-2020.

```{r echo=FALSE}

#create regression models
 models <- list(


 'Dynamic Model (Year FE)' = feols(SI.POV.GINI ~  lag_gini + SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date   , data=reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(SI.POV.GINI ~  lag_gini +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  | date  , data=reg_df, se='cluster', cluster='country') ,
   
   
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date, data=reg_df, se='cluster', cluster='country') ,
 # 
 # 'Longitudinal Model (Year FE)' = feols(log(NY.GDP.PCAP.KD) ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date , data=reg_df, se='cluster', cluster='country') ,

 # 'Longitudinal Model (Country RE/Year FE)' = plm::plm(log(NY.GDP.PCAP.KD) ~  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  + factor(date), data=reg_df, model='random', index=c('iso3c')) ,
 # 

 'Longitudinal Model (Country FE/Year FE)' = feols(SI.POV.GINI ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Longitudinal Model (Country FE/Year FE)' = feols(SI.POV.GINI ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS +  SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=SI.POV.GINI ~ lag(SI.POV.GINI, 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(SI.POV.GINI, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date')),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=SI.POV.GINI ~ lag(SI.POV.GINI, 1) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(SI.POV.GINI, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date'))
 

 )



 modelsummary(models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"HC1",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "log(lag_gini)" = "lagged Gini" ,
                              "lag(SI.POV.GINI, 1)" = "lagged Gini" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "HD.HCI.OVRL" = "Human Capital Index (0-1 scale)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "WGI.OVL" = "WGI Index",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include NY.GDP.MKTP.KD.ZG, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level"
              #escape = FALSE
              )

```


## Intermediate Impacts on the economy

In addition to looking at the association of improvements in statistical performance on GDP per capita, two additional associations are considered: improvements in government effectiveness according to the WGI and reductions in dollar denominated government bond spreads.^[ A version of the bond spreads analysis was first published in a World Bank blog post(https://blogs.worldbank.org/opendata/not-all-data-are-created-equal-why-adoption-international-data-standards-pays) by Lucas Kitzmueller, Brian Stacy, Daniel Mahler, and Umar Serajuddin on September 1, 2021.]  A very similar econometric model is used for these two additional outcomes: a dynamic model and a longitudinal model with country fixed effects.


In the case of government effectiveness, the lag of government effectiveness is included in the dynamic model (rather than log lagged GDP per capita). Additionally, the sectoral composition (manufacturing and agriculture) and trade control variables are excluded from the analysis as there is no clear theoretical reason for why these controls should affect government effectiveness.  Government effectiveness is measured using the World Governance Indicators.

In the table below, there is no detectable relationship between the SPI overall score and government effectiveness in the dynamic or longitudinal models.  However, the SPI pillar 2 score on data services and openness has a statistically significant association at the 5% level in the dynamic model, with a similar sign and magnitude but insignificant in the longitudinal model.  A ten unit improvement in data services is associated with an improvement of .01 standard deviations of government effectiveness.  The SPI pillar 3 scores on data sources is statistically significant at the 1% level in the longitudinal model suggesting a 10 point improvement in data products, measuring the availability of SDG indicators for the country, is associated with a .04 standard deviation improvement in government effectiveness.  One interpretation is that additional access (pillar 2) and availability (pillar 3) of data for the country improves government effectiveness.

Table. Relationship between Government Effectiveness and SPI scores using data from 2016-2020.

```{r}

cross_reg_ge_df <- reg_df %>%
  arrange(country) %>%
  group_by(country, iso3c) %>%
  summarise(init_ge=last(GE.EST),
            GE.EST=first(GE.EST),
            across(c('SPI.INDEX','NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','NE.TRD.GNFS.ZS','SE.PRM.ENRR', 'HD.HCI.OVRL','BN.CAB.XOKA.GD.ZS', 'CC.EST', 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "WGI.OVL",'region'),~last(.))
            
            )

reg_ge_df <- reg_df %>%
  arrange(iso3c,date) %>%
  group_by(iso3c) %>%
  mutate(growth=GE.EST-lag(GE.EST)) 

#create regression models
 GE_models <- list(


  'Dynamic Model (Year FE)' = feols(GE.EST ~  lag_ge + SPI.INDEX + SE.PRM.ENRR | date   , data=reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(GE.EST ~  lag_ge +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + SE.PRM.ENRR  | date  , data=reg_df, se='cluster', cluster='country') ,
 

 'Longitudinal Model (Country FE/Year FE)' = feols(GE.EST ~  SPI.INDEX +  SE.PRM.ENRR   | country+date , data=reg_df) ,
 
  'Longitudinal Model (Country FE/Year FE)' = feols(GE.EST ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 +  SE.PRM.ENRR   | country+date , data=reg_df) ,
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=GE.EST ~ lag(GE.EST, 1) +  SPI.INDEX +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(GE.EST, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date')),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=GE.EST ~ lag(GE.EST, 1) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 +  NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | lag(GE.EST, 2), data=reg_df, model='twosteps', effect='twoways', index=c('iso3c', 'date'))

 )


 modelsummary(GE_models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"stata",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "lag_ge" = "lagged Government Effectiveness" ,
                              "lag(GE.EST, 1)" = "lagged Government Effectiveness" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BX.KLT.DINV.WD.GD.ZS"= "Foreign direct investment, net inflows (% of GDP)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include BX.KLT.DINV.WD.GD.ZS, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level",
              escape = FALSE
              )
```



```{r bonddata}
# Bonds

# Load data

sp <- readxl::read_excel("C:/Users/wb469649/OneDrive - WBG/DECIS/SPI/Blog - SPI and Bond Spreads/01_Data/LIB127603_govt bond spreads_final.xlsx", 
                 sheet = "batch1")
# data are 10 year govt bonds, yield to maturity, with us govt bonds as benchmark

# This reshaping is a bit unconventional but does the job. The problem is that the date varies across columns, and therefore we can't use "normal" pivot_longer() or gather()

sp_dates <- pivot_longer(select(sp, contains("date")), contains("date"), names_to = "name_date", values_to = "date")
sp_dates$ID <- seq.int(nrow(sp_dates))

sp_values <- pivot_longer(select(sp, contains("value")), contains("value"))
sp_values$ID <- seq.int(nrow(sp_dates))

df <-  left_join(sp_dates, sp_values)

# Clean up df
df$name <- substr(df$name,1,3)
df <- df %>% select(-c(ID, name_date))
df <- df %>% rename(iso3c =  name)
df <- df %>% rename(spread =  value)
df<-df[!(df$iso3c=="VEN"),] # remove venezuela
df<-df[!(df$iso3c=="ARG"),] # and argentina as huge outliers

#usa$date <- axis.Date(1, as.Date(usa$date, origin = "1970-01-01"))

# Extract year from date variable and summarize by year
df$year <- format(df$date, format = "%Y")
df <- select(df,-c("date"))

# Add USA (by definition, spread of 0)
usa<-tibble(year = c(2021,2020,2019,2018,2017,2016,2015),
            iso3c = rep("USA",7),
            spread = rep(0,7))
df <- rbind(df, usa)

# Summarize by year
bond_spread_summary_df <- df %>%
  group_by(year, iso3c) %>%
  summarise(spread = mean(spread, na.rm = TRUE)) %>%
  arrange(iso3c, year) %>%
  group_by(iso3c) %>%
  mutate(lag_spread=lag(spread)) %>%
  ungroup()

bond_spread_summary_df$date <- as.numeric(bond_spread_summary_df$year)


#get relevant data from WDI
# select relevant series and years
relevant_series = c("GC.DOD.TOTL.GD.ZS", "BN.CAB.XOKA.GD.ZS", "NY.GDP.MKTP.KD.ZG", "NY.GDP.PCAP.KD", "NE.TRD.GNFS.ZS", "FP.CPI.TOTL.ZG", "DT.DOD.DECT.GN.ZS")

bond_control_df <- wbstats::wb_data(country="countries_only",
             indicator=relevant_series,
             start_date=2010,
             end_date=2020) %>%
  mutate(date=as.numeric(date)) %>%
  group_by(iso3c) %>%
  fill(relevant_series, .direction="downup") %>%
  ungroup() 


bond_control_df <- bond_control_df %>%
  left_join(imf_dta)

bond_spread_reg_df <- SPI_2016 %>%
  select(country, iso3c, date, region, starts_with('SPI.INDEX')) %>%
  left_join(bond_control_df) %>%
  left_join(bond_spread_summary_df) %>%
  filter(!(is.na(spread) | is.na(SPI.INDEX)  | 
             is.na(BN.CAB.XOKA.GD.ZS) |
             is.na(NY.GDP.MKTP.KD.ZG) |
             is.na(NY.GDP.PCAP.KD) |
             is.na(NE.TRD.GNFS.ZS) |
             is.na(FP.CPI.TOTL.ZG) |
             is.na(cg)  ))

country_num_bonds <- length(unique(bond_spread_reg_df$country))

country_list_bonds <- paste(unique(bond_spread_reg_df$country), collapse = ", ")

```
An analysis of the impacts of improvements on the SPI on 10 year dollar denominated government bond spreads is below.  The 10 year dollar denominated government bond spreads measure the additional costs of borrowing money for a country relative to the U.S.A.  The regression model includes the level of GDP per capita, the GDP growth rate, trade as a percentage of GDP, the current account balance as a percentage of GDP, and the central government total debt as a percentage of GDP as a control.  

The data on 10 year dollar denominated government bond spreads was collected from Bloomberg from the period 2015 to 2020 for `r country_num_bonds`.^[The countries where bond spreads were collected includes `r country_list_bonds`.]  These countries had data available from Bloomberg over the period.

The dynamic model in column (1) indicates that an improvement of 10 points on the SPI overall score is associated with a reduction in bond spreads of roughly 37 basis points, which would be equivalent to a reduction of interest rates of .37 percentage points.  Column (2) indicates that this is driven by the improvements in data infrastructure (pillar 5), which indicate that a 10 point improvement in data infrastructure is associated with a reduction of around 16 basis points in bond spreads.  Data infrastructure includes several indicators on whether for instance the country uses the latest system of national accounts, system of classifying monetary and financial statistics, system of government finance statistics, and system of central government accounting, and has a recent CPI base year.

The estimates from the longitudinal model are highly imprecise in column (3) and (4), so no clear relationships can be identified.  The Arellano and Bond estimator has large standard errors as well.

Table. Relationship between Dollar Denominated Government Bond Spreads and SPI scores using data from 2016-2020.

```{r}





bond_models <- list(

  
  'Dynamic Model (Year FE)' = feols(spread ~  lag_spread  + SPI.INDEX  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg | date   , data=bond_spread_reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(spread ~  lag_spread  + SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg  | date  , data=bond_spread_reg_df, se='cluster', cluster='country') ,
 
    'Longitudinal Model (Country FE/Year FE)' = feols(spread ~  SPI.INDEX  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg | country+date , data=bond_spread_reg_df, se='cluster', cluster='country'), 
 
     'Longitudinal Model (Country FE/Year FE)' = feols(spread ~   SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg | country+date , data=bond_spread_reg_df, se='cluster', cluster='country'),
 
  'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=spread ~ lag(spread, 1) +   SPI.INDEX  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg | lag(spread, 2), data=bond_spread_reg_df, model='twosteps', effect='twoways', index=c('country', 'date')),
 
 'Arellano & Bond Panel GMM (Country FE/Year FE)' = pgmm(formula=spread ~ lag(spread, 1) +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5  + BN.CAB.XOKA.GD.ZS + NY.GDP.MKTP.KD.ZG + NY.GDP.PCAP.KD + NE.TRD.GNFS.ZS + FP.CPI.TOTL.ZG + cg | lag(spread, 2), data=bond_spread_reg_df, model='twosteps', effect='twoways', index=c('country', 'date'))

 )


 modelsummary(bond_models,
              estimate= "{estimate}{stars}",
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "lag_spread" = "lagged Bond Spread" ,
                              "lag(spread, 1)" = "lagged Bond Spread",
                              "cg"  = "Central government debt, total (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "NY.GDP.MKTP.KD.ZG"= "GDP per capita (constant 2015 US$)",
                              "NY.GDP.PCAP.KD" = "GDP growth (annual %)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "FP.CPI.TOTL.ZG" = "Inflation, consumer prices (annual %)",
                              "DT.DOD.DECT.GN.ZS" = "External debt stocks (% of GNI)"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include BN.CAB.XOKA.GD.ZS, NY.GDP.MKTP.KD.ZG, NY.GDP.PCAP.KD,SE.PRM.ENRR,NE.TRD.GNFS.ZS, NE.TRD.GNFS.ZS, FP.CPI.TOTL.ZG.  Central government debt data came from IMF.  Data for year 2016-2020.  Data accessed on March 15, 2022.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value.",
              escape = FALSE
              )

```

The results from this regression analysis indicate improving statistical performance can have impacts on the macroeconmy of a country and the country's government effectiveness.  Improvements of 10 points on the SPI overall score, which would be near the performance of the 75th percentile country between 2016 and 2020,has an impact in the range of 0-1% on GDP per capita depending on the model.  It is associated with a 37 basis point improvement in government bond spreads in one model.  Finally, the underlying pillars of the SPI are associated with multiple outcomes.  A 10 unit increase in the SPI data infrastructure score (pillar 5) is associated with a statistically significant 0-1% improvement in GDP per capita and a 16 basis point reduction in bond spreads.  A 10 unit increase in data services, including openness, (pillar 2) is associated with a .01 standard deviation improvement in government effectiveness according to the WGI, and a 10 unit increase in data products, or the availability of SDG indicators, is assocaited with a .04 standard deviation improvement in government effectiveness.



```{r eval=FALSE, include=FALSE}
#create regression models

cross_reg_fdi_df <- reg_df %>%
  arrange(country) %>%
  group_by(country, iso3c) %>%
  summarise(growth=first(BX.KLT.DINV.WD.GD.ZS)-last(BX.KLT.DINV.WD.GD.ZS),
            across(c('SPI.INDEX','NY.GDP.PCAP.KD','NV.IND.MANF.ZS', 'NV.AGR.TOTL.ZS','NE.TRD.GNFS.ZS','SE.PRM.ENRR', 'HD.HCI.OVRL','BN.CAB.XOKA.GD.ZS', 'CC.EST', "GE.EST", 'PV.EST', "RQ.EST", "RL.EST", "VA.EST", "WGI.OVL",'region'),~last(.))
            
            )

 bond_models <- list(


 'Dynamic Model (Year FE)' = feols(BX.KLT.DINV.WD.GD.ZS ~  lag_fdi + SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | date   , data=reg_df, se='cluster', cluster='country') ,

 'Dynamic Model (Year FE)' = feols(BX.KLT.DINV.WD.GD.ZS ~  lag_fdi +  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL  | date  , data=reg_df, se='cluster', cluster='country') ,

 'Longitudinal Model (Country FE/Year FE)' = feols(BX.KLT.DINV.WD.GD.ZS ~  SPI.INDEX + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country'),
 
 'Longitudinal Model (Country FE/Year FE)' = feols(BX.KLT.DINV.WD.GD.ZS ~  SPI.INDEX.PIL1 + SPI.INDEX.PIL2 + SPI.INDEX.PIL3 + SPI.INDEX.PIL4 + SPI.INDEX.PIL5 + NV.IND.MANF.ZS + NV.AGR.TOTL.ZS + SE.PRM.ENRR  + NE.TRD.GNFS.ZS + WGI.OVL | country+date , data=reg_df, se='cluster', cluster='country') 

 )


 modelsummary(bond_models,
              estimate= "{estimate}{stars}",
              #vcov=list(NULL,"HC1",NULL),
              coef_rename = c("SPI.INDEX"  = "SPI Overall Score",
                              "SPI.INDEX.PIL1"  = "SPI Pillar 1 Score",
                              "SPI.INDEX.PIL2"  = "SPI Pillar 2 Score",
                              "SPI.INDEX.PIL3"  = "SPI Pillar 3 Score",
                              "SPI.INDEX.PIL4"  = "SPI Pillar 4 Score",
                              "SPI.INDEX.PIL5"  = "SPI Pillar 5 Score",
                              "lag_fdi" = "lagged FDI" ,
                              "NV.IND.MANF.ZS"  = "Manufacturing value added (% of GDP)",
                              "NV.AGR.TOTL.ZS"= "Agriculture, forestry, fishing value added (% of GDP)",
                              "BN.CAB.XOKA.GD.ZS"= "Current account balance (% of GDP)",
                              "HD.HCI.OVRL" = "Human Capital Index (0-1 scale)",
                              "SE.PRM.ENRR" = "School Enrollment, Primary (% gross)" ,
                              "NE.TRD.GNFS.ZS" = "Trade (% of GDP)",
                              "WGI.OVL" = "WGI Index",
                              "CC.EST" = "WGI: Control of Corruption: Estimate",
                              "GE.EST" = "WGI: Governance Effectiveness: Estimate",
                              "PV.EST" = "WGI: Political Stability and Absence of Violence/Terrorism: Estimate",
                              "RQ.EST" = "WGI: Regulatory Quality: Estimate",
                              "RL.EST" = "WGI: Rule of Law: Estimate",
                              "VA.EST" = "WGI: Voice and Accountability: Estimate"),
              gof_map = gm,
              notes="Data from the World Bank's World Development Indicators (WDI) and SPI.  WDI series codes include BX.KLT.DINV.WD.GD.ZS, NV.IND.MANF.ZS, NV.AGR.TOTL.ZS,SE.PRM.ENRR,BN.CAB.XOKA.GD.ZS, CC.EST, GE.EST, PV.EST, RQ.EST, RL.EST, VA.EST.  Data for year 2016-2020.  Data accessed on March 15, 2022.  Dynamic model includes lagged outcome in model.  Longitudinal model controls for country fixed effects.  In cases where data is missing for a particular covariate, the data is imputed using the nearest available value. Standard errors clustered at the country level.
              ***=0.001 level
              **=0.01 level
              *=0.05 level
              +=0.1 level",
              escape = FALSE
              )
```